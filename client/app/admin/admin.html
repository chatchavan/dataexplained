<div class="navbar navbar-default navbar-static-top">
  <div class="admin-navbar">
    <div class="navbar-collapse collapse" id="navbar-main">
      <ul class="nav navbar-nav">
        <li>
          <a ng-click="admin.loadTest = false;">Admin Dashboard Develop</a>
        </li>
        <li>
          <a ng-click="admin.loadTest = true;">Load-Test</a>
        </li>
      </ul>
    </div>
  </div>
</div>

<div class="admin" id="admin-container" ng-if="!admin.loadTest">

  <div class="margin-top-medium top-title">
    <h2>User information</h2>  <md-button class="md-raised" ng-click="admin.goAnalysis()">Analysis as Admin</md-button>
    <label for="survey" class="control-label">Enable survey</label>
    <input class="" type="checkbox" ng-click="admin.setSurvey()" ng-model="admin.configSurvey" id="survey">
    <md-button class="mg-raised pull-right" ng-click="admin.logout()">Logout</md-button>

    <div class="title-container">
      <md-button class="md-raised first-button" ng-click="admin.displayAllUsers()">Show all users</md-button>
      <label for="username" class="control-label">User-name</label>
      <input type="text" class="" name="username" id="username" placeholder="" ng-model="admin.searchUser"
              required>
      <md-button class="md-raised" ng-click="admin.showWorkflow()">Show Workflow</md-button>
      <md-button class="md-raised" ng-click="admin.showBlocks()">Show Blocks</md-button>
      <md-button class="md-raised" ng-click="admin.createUser()">Create User</md-button>
      <md-button ng-if="admin.plumbJson" class="md-raised" ng-click="admin.downloadWorkflow()">Download Workflow</md-button>


    </div>

  </div>

  <table class="table table-striped table-condensed admin-table" ng-if="admin.displayUsers">
    <thead>
    <tr>
      <th>Username</th>
      <th>Survey Done?</th>
      <th>Finished?</th>
      <th></th>
    </tr>
    </thead>
    <tbody>
    <tr ng-repeat="user in admin.users | orderBy: 'username' | filter : admin.searchUser">
      <td class="cursorpointer" ng-click="admin.searchUser = user.username">{{user.username}}</td>
      <td><span class="label" ng-class="{'label-success' : user.surveyDone, 'label-danger' : !user.surveyDone}"
                ng-click="admin.toggleSurvey(user)">{{user.surveyDone}}</span></td>
      <td><span class="label" ng-class="{'label-success' : user.finished, 'label-danger' : !user.finished}"
                ng-click="admin.toggleFinished(user)">{{user.finished}}</span></td>
      <td>
        <i class="fa fa-undo" aria-hidden="true" ng-click="admin.resetUser(user)"></i>
        <i class="fa fa-trash" aria-hidden="true" ng-click="admin.deleteUser(user)"></i>
        <i class="fa fa-download" aria-hidden="true" ng-click="admin.exportCsv(user)"></i>
      </td>
    </tr>
    </tbody>
  </table>


  <div ng-if="admin.noWorkflow">
    <h4>No workflow for "{{admin.searchUser}}" found.</h4>
  </div>
  <div ng-if="admin.userNotFound">
    <h4>User "{{admin.searchUser}}" not found.</h4>
  </div>
  <div ng-if="admin.textCallback">
    <h4>{{admin.textCallback}}</h4>
  </div>

  <div ng-if="admin.itemlist" ng-repeat="item in admin.itemlist" class="panel panel-default margin-top-medium" id="panel_{{$index}}">
    <div class="panel-heading" data-toggle="collapse" data-target="#collapse_{{$index}}">
      <span ng-if="item.renderedContent && item.content.length>0" class="pull-right fa fa-arrows-v"></span>
      <span ng-if="item.renderedContent" ng-click="admin.editBlock(item)"
            class="pull-right fa fa-pencil-square-o"></span>
      <h4 ng-if="item.renderedContent" class="panel-title">
        <a data-toggle="collapse" data-target="#collapse_{{$index}}"href="#collapse_{{$index}}">{{item.title}}</a>
      </h4>
    </div>

    <div ng-if="item.renderedContent" id="collapse_{{$index}}"
         class="panel-collapse collapse out fade">
      <div class="panel-body">
        <p ng-repeat="c in item.renderedContent track by $index">{{c}}</p>
      </div>
     </div>

  </div>

</div>

<div class="jsplumb-container" id="plumb-container">
  <js-plump class="jsplumb" ng-if="admin.plumbJson && !admin.loadTest" plumb-list="admin.plumbList" json="admin.plumbJson" instance="admin.plumbInstance" user="admin.searchUser"></js-plump>
</div>

<loadtest ng-if="admin.loadTest"></loadtest>


